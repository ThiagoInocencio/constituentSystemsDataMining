# install.packages("magrittr")
# install.packages("dplyr")
# install.packages("mlr")
# install.packages("corrplot")
# install.packages("caret")
# install.packages("pca3d")

#library(magrittr)
library(tictoc)
library(dplyr)
library(mlr)
library(corrplot)
library(caret)
library(plyr)
library(pca3d)

library(devtools)
#install_github("vqv/ggbiplot")

library(ggbiplot)

dataImputation = function(temp) {

  if(any(is.na(temp))) {
    cat(" - doing imputation\n")
    imp = impute(temp, target =character(0), classes = list(integer = imputeMean(), factor = mlr::imputeConstant(const = "New Class"), character = mlr::imputeConstant(const = "New Class"))
    )
    temp = imp$data
  }
  return(temp)
}

#### Loading dataset from file. Loading data generated by source forge scrapper:
data <- read.csv('R/datasets/dataset.csv', header = TRUE, stringsAsFactors = FALSE)

tic("execution time: ")
newData <- dataImputation(data)
toc()

write.csv(newData,'R/datasets/data_set_base_C.csv', row.names = FALSE)
